apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  annotations:
    tsb.tetrate.io/gatewayGroup: {{ gatewayGroupName }}
    tsb.tetrate.io/tenant: {{ tenantName }}
    tsb.tetrate.io/organization: {{ orgName }}
    tsb.tetrate.io/workspace: {{ workspaceName }}
  name: {{ gatewayName }}
  namespace: {{ (namespaces and namespaces["product"]) or namespace }}
spec:
  selector:
    app: tsb-gateway-{{ (namespaces and namespaces["product"]) or namespace }}
  servers:
  - hosts:
    - {{ (namespaces and namespaces["product"]) or namespace }}/{{ hostname }}
    port:
      name: https-bookinfo-direct
      number: 8443
      protocol: HTTPS
    tls:
      credentialName: {{ gwSecretName }}
      mode: SIMPLE
